'use strict';

var gridApp = angular.module('grid-app', [  
  'ui.bootstrap',                                            
  'angularMoment',
  'grid-app-service'
]);

gridApp.controller('grid-app-controller', ['$rootScope', '$scope', 'gridAppService', function($rootScope, $scope, gridAppService) {

    $rootScope.gridAppService = gridAppService;

    $scope.changeView = function(view, action){
        $rootScope.view = view;
        $rootScope.action = action;
    }
    
}]);

gridApp.service('timestamp', function() {
  return {
    toAge: function(ts) {
      var age = Date.now() - parseInt(ts);
      age = Math.floor(age / 1000);
      if (age == 1) return age + ' second';
      if (age < 60) return age + ' seconds';
      age = Math.floor(age / 60);
      if (age == 1) return age + ' minute';
      if (age < 60) return age + ' minutes';
      age = Math.floor(age / 60);
      if (age == 1) return age + ' hour';
      if (age < 24) return age + ' hours';
      age = Math.floor(age / 24);
      if (age == 1) return age + ' day';
      if (age < 7) return age + ' days';
      age = Math.floor(age / 7);
      if (age == 1) return age + ' week';
      if (age < 4) return age + ' weeks';
      age = Math.floor(age / 4);
      if (age == 1) return age + ' month';
      return age + ' months';
    },
    toDelta: function(ts1, ts2) {
      var delta = parseInt(ts2) - parseInt(ts1);
      if (delta > 0) return '+'+delta+'ms';
      return delta+'ms';
    }
  }
});
